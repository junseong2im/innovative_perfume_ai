# Fragrance AI μ‹μ¤ν… κµ¬ν„ κΈ°λ΅

## ν”„λ΅μ νΈ κ°μ”
ν–¥μ λ μ‹ν”Ό μƒμ„±κ³Ό μλ―Έ κΈ°λ° κ²€μƒ‰μ„ μ„ν• μƒμ©ν™” μμ¤€μ AI μ‹μ¤ν…

## μ™„λ£λ κµ¬ν„ μ‚¬ν•­

### 1. β… ν”„λ΅μ νΈ κµ¬μ΅° (Project Structure)
```
fragrance_ai/
β”β”€β”€ core/
β”‚   β”β”€β”€ config.py           # μ„¤μ • κ΄€λ¦¬
β”‚   β””β”€β”€ vector_store.py     # λ²΅ν„° DB κ΄€λ¦¬
β”β”€β”€ models/
β”‚   β”β”€β”€ embedding.py        # ν•κµ­μ–΄ νΉν™” μ„λ² λ”©
β”‚   β””β”€β”€ generator.py        # λ μ‹ν”Ό μƒμ„± λ¨λΈ
β”β”€β”€ training/
β”‚   β””β”€β”€ peft_trainer.py     # PEFT ν›λ ¨ μ‹μ¤ν…
β”β”€β”€ api/
β”‚   β”β”€β”€ main.py            # FastAPI λ©”μΈ
β”‚   β”β”€β”€ schemas.py         # λ°μ΄ν„° μ¤ν‚¤λ§
β”‚   β”β”€β”€ middleware.py      # λ―Έλ“¤μ›¨μ–΄
β”‚   β”β”€β”€ dependencies.py    # μμ΅΄μ„± κ΄€λ¦¬
β”‚   β””β”€β”€ routes/           # API λΌμ°νΈ
β”‚       β”β”€β”€ search.py     # κ²€μƒ‰ μ—”λ“ν¬μΈνΈ
β”‚       β”β”€β”€ generation.py # μƒμ„± μ—”λ“ν¬μΈνΈ
β”‚       β”β”€β”€ training.py   # ν›λ ¨ μ—”λ“ν¬μΈνΈ
β”‚       β””β”€β”€ admin.py      # κ΄€λ¦¬ μ—”λ“ν¬μΈνΈ
β””β”€β”€ requirements.txt      # μμ΅΄μ„± ν¨ν‚¤μ§€
```

### 2. β… μλ―Έ κΈ°λ° κ²€μƒ‰ μ‹μ¤ν… (Semantic Search)
- **ChromaDB** κΈ°λ° λ²΅ν„° λ°μ΄ν„°λ² μ΄μ¤
- ν•μ΄λΈλ¦¬λ“ κ²€μƒ‰ (μ—¬λ¬ μ»¬λ ‰μ… λ™μ‹ κ²€μƒ‰)
- μ»¬λ ‰μ…λ³„ κ°€μ¤‘μΉ μ μ©
- μ μ‚¬λ„ μ„κ³„κ°’ ν•„ν„°λ§
- λ°°μΉ λ¬Έμ„ μ¶”κ°€/μ—…λ°μ΄νΈ

**μ£Όμ” κΈ°λ¥:**
- `semantic_search()` - λ‹¨μΌ/ν•μ΄λΈλ¦¬λ“ κ²€μƒ‰
- `batch_add_fragrance_notes()` - ν–¥λ£ λ…ΈνΈ λ°°μΉ μ¶”κ°€
- `get_similar_items()` - μ μ‚¬ μ•„μ΄ν… κ²€μƒ‰

### 3. β… ν•κµ­μ–΄ νΉν™” μ„λ² λ”© (Korean Embedding)
- **Sentence-BERT** κΈ°λ° λ‹¤κµ­μ–΄ λ¨λΈ
- ν–¥μ μ „λ¬Έ μ–΄ν μ‚¬μ „ λ‚΄μ¥
- μ»¨ν…μ¤νΈ κ°•ν™” κΈ°λ¥
- λ°°μΉ μ²λ¦¬ μ§€μ›

**νΉν™” κΈ°λ¥:**
- ν–¥μ λ…ΈνΈλ³„ μλ―Έ κ°•ν™” (ν†±/λ―Έλ“¤/λ² μ΄μ¤)
- λ¬΄λ“ λ””μ¤ν¬λ¦½ν„° λ§¤ν•‘
- κ³„μ /μ„±κ²© νƒκ·Έ μ²λ¦¬
- ν”„λ΅ν•„ μΆ…ν•© μ„λ² λ”©

### 4. β… λ μ‹ν”Ό μƒμ„± μ‹μ¤ν… (Recipe Generation)
- **Llama/Mistral** κΈ°λ° μƒμ„± λ¨λΈ
- 4bit μ–‘μν™”λ΅ λ©”λ¨λ¦¬ ν¨μ¨μ„±
- ν…ν”λ¦Ώ κΈ°λ° κµ¬μ΅°ν™” μ¶λ ¥
- ν’μ§ ν‰κ°€ μ‹μ¤ν…

**μƒμ„± νƒ€μ…:**
- `basic_recipe` - κΈ°λ³Έ λ μ‹ν”Ό
- `detailed_recipe` - μƒμ„Έ λ μ‹ν”Ό
- `premium_recipe` - ν”„λ¦¬λ―Έμ—„ λ μ‹ν”Ό

### 5. β… PEFT ν›λ ¨ μ‹μ¤ν… (LoRA/QLoRA)
- **LoRA** (Low-Rank Adaptation) κµ¬ν„
- **QLoRA** 4bit μ–‘μν™” μ§€μ›
- Weights & Biases λ¨λ‹ν„°λ§
- μ΅°κΈ° μΆ…λ£ λ° μ²΄ν¬ν¬μΈνΈ
- μ–΄λ‘ν„° λ³‘ν•©/μ €μ¥

**ν›λ ¨ κΈ°λ¥:**
- ν¨μ¨μ μΈ νλΌλ―Έν„° μ—…λ°μ΄νΈ
- λ©”λ¨λ¦¬ μ‚¬μ©λ‰ μµμ†ν™”
- λ°°μΉ μ²λ¦¬ λ° ν‰κ°€
- λ¨λΈ ν’μ§ μΈ΅μ •

### 6. β… FastAPI λ°±μ—”λ“ μ‹μ¤ν…
- **λΉ„λ™κΈ° μ²λ¦¬** μ§€μ›
- μƒλ…μ£ΌκΈ° κ΄€λ¦¬
- λ¨λΈ μƒνƒ κ΄€λ¦¬
- μ—λ¬ ν•Έλ“¤λ§

**API μ—”λ“ν¬μΈνΈ:**
```
/api/v1/search/* - μλ―Έ κ²€μƒ‰
/api/v1/generate/* - λ μ‹ν”Ό μƒμ„±
/api/v1/training/* - λ¨λΈ ν›λ ¨
/api/v1/admin/* - μ‹μ¤ν… κ΄€λ¦¬
```

**λ―Έλ“¤μ›¨μ–΄:**
- λ΅κΉ…, μ†λ„ μ ν•, λ³΄μ•, μΊμ‹±, λ©”νΈλ¦­μ¤

## μ§„ν–‰ μ¤‘μΈ μ‘μ—…

### π”„ λ°μ΄ν„°λ² μ΄μ¤ μ¤ν‚¤λ§ μ„¤κ³„
- PostgreSQL μ¤ν‚¤λ§ μ •μ
- SQLAlchemy ORM λ¨λΈ
- λ§μ΄κ·Έλ μ΄μ… μ¤ν¬λ¦½νΈ

### π“‹ λ‚¨μ€ μ‘μ—… (TODO)

1. **λ°μ΄ν„° νμ΄ν”„λΌμΈ κµ¬μ¶•**
   - Apache Airflow μ›ν¬ν”λ΅μ°
   - μ›Ή μ¤ν¬λν•‘ μλ™ν™”
   - λ°μ΄ν„° μ •μ /λ³€ν™
   - μ„λ² λ”© μ—…λ°μ΄νΈ μλ™ν™”

2. **λ¨λΈ ν‰κ°€/μµμ ν™” μ‹μ¤ν…**
   - A/B ν…μ¤νΈ ν”„λ μ„μ›ν¬
   - μ„±λ¥ λ²¤μΉλ§ν‚Ή
   - λ¨λΈ λΉ„κµ/λ¶„μ„
   - μλ™ ν•μ΄νΌνλΌλ―Έν„° νλ‹

## κΈ°μ  μ¤νƒ

### AI/ML
- **Transformers**: 4.35.2 (λ¨λΈ λ΅λ”©/μ¶”λ΅ )
- **Sentence-Transformers**: 2.2.2 (μ„λ² λ”©)
- **PEFT**: 0.6.2 (ν¨μ¨μ  λ―Έμ„Έμ΅°μ •)
- **ChromaDB**: 0.4.18 (λ²΅ν„° DB)
- **PyTorch**: 2.1.0 (λ”¥λ¬λ‹)

### λ°±μ—”λ“
- **FastAPI**: 0.104.1 (μ›Ή ν”„λ μ„μ›ν¬)
- **SQLAlchemy**: 2.0.23 (ORM)
- **Redis**: 5.0.1 (μΊμ‹±/μ„Έμ…)
- **Celery**: 5.3.4 (λΉ„λ™κΈ° μ‘μ—…)

### λ¨λ‹ν„°λ§
- **Weights & Biases**: 0.16.0 (ML μ‹¤ν— μ¶”μ )
- **Prometheus**: λ©”νΈλ¦­ μμ§‘
- **TensorBoard**: λ¨λΈ μ‹κ°ν™”

## λ°°ν¬ κ³ λ ¤μ‚¬ν•­

### μΈν”„λΌ
- **GPU μ„λ²„**: NVIDIA A100/V100 κ¶μ¥
- **λ©”λ¨λ¦¬**: 32GB+ RAM, 16GB+ VRAM
- **μ¤ν† λ¦¬μ§€**: SSD 500GB+ (λ¨λΈ/λ°μ΄ν„°)

### μ„±λ¥ μµμ ν™”
- **vLLM**: μ¶”λ΅  μ†λ„ μµμ ν™”
- **Triton**: λ¨λΈ μ„λΉ™
- **ONNX**: λ¨λΈ μµμ ν™”
- **λ°°μΉ μ²λ¦¬**: λ™μ‹ μ”μ²­ μ²λ¦¬

### λ³΄μ•
- API ν‚¤ μΈμ¦
- Rate Limiting
- μ…λ ¥ κ²€μ¦/ν•„ν„°λ§
- HTTPS/λ³΄μ• ν—¤λ”

## λΌμ΄μ„Όμ¤ λ° κ·μ •μ¤€μ
- μ¤ν”μ†μ¤ λ¨λΈ λΌμ΄μ„Όμ¤ ν™•μΈ ν•„μ”
- μƒμ© μ΄μ© μ‹ Hugging Face λΌμ΄μ„Όμ¤ κ²€ν† 
- κ°μΈμ •λ³΄λ³΄νΈ κ·μ • μ¤€μ

## μ™„λ£λ μ¶”κ°€ κµ¬ν„ μ‚¬ν•­

### 7. β… μ„λΉ„μ¤ λ μ΄μ–΄ (Service Layer)
- **SearchService**: ν†µν•© κ²€μƒ‰ μ„λΉ„μ¤
- **GenerationService**: λ μ‹ν”Ό μƒμ„± μ„λΉ„μ¤
- μΊμ‹±, λ°°μΉ μ²λ¦¬, ν’μ§ ν‰κ°€ λ‚΄μ¥
- λΉ„λ™κΈ° μ²λ¦¬ λ° μ—λ¬ ν•Έλ“¤λ§

**μ£Όμ” κΈ°λ¥:**
```python
search_service.semantic_search()    # μλ―Έ κΈ°λ° κ²€μƒ‰
generation_service.generate_recipe()  # λ μ‹ν”Ό μƒμ„±
generation_service.batch_generate()   # λ°°μΉ μƒμ„±
```

### 8. β… λ°μ΄ν„°λ² μ΄μ¤ λ¨λΈ (Database Models)
- **SQLAlchemy ORM** κΈ°λ° λ¨λΈ μ„¤κ³„
- PostgreSQL μµμ ν™”λ μ¤ν‚¤λ§
- Alembic λ§μ΄κ·Έλ μ΄μ… μ‹μ¤ν…
- μΈλ±μ¤ λ° μ μ•½μ΅°κ±΄ μµμ ν™”

**ν•µμ‹¬ λ¨λΈ:**
- `FragranceNote` - ν–¥λ£ λ…ΈνΈ
- `Recipe` - ν–¥μ λ μ‹ν”Ό
- `RecipeIngredient` - λ μ‹ν”Ό μ¬λ£
- `TrainingDataset` - ν›λ ¨ λ°μ΄ν„°μ…‹
- `ModelCheckpoint` - λ¨λΈ μ²΄ν¬ν¬μΈνΈ
- `SearchLog` / `GenerationLog` - μ‚¬μ© λ΅κ·Έ

### 9. β… ν‰κ°€ μ‹μ¤ν… (Evaluation System)
- **EvaluationMetrics**: μΆ…ν•© λ©”νΈλ¦­ κ³„μ‚°
- **QualityAssessment**: λ μ‹ν”Ό ν’μ§ ν‰κ°€
- μ„λ² λ”© λ¨λΈ ν‰κ°€ (Precision@K, NDCG, MRR)
- μƒμ„± λ¨λΈ ν‰κ°€ (μ°½μμ„±, μ‹¤ν„κ°€λ¥μ„±, μΌκ΄€μ„±)

**ν‰κ°€ λ©”νΈλ¦­:**
```python
# μ„λ² λ”© ν‰κ°€
precision@k, recall@k, ndcg@k, map@k, mrr

# μƒμ„± ν‰κ°€  
structure_score, creativity_score, feasibility_score
avg_quality_score, diversity_score
```

### 10. β… ν›λ ¨/ν‰κ°€ μ¤ν¬λ¦½νΈ (Training & Evaluation Scripts)
- **train_model.py**: ν†µν•© λ¨λΈ ν›λ ¨ μ¤ν¬λ¦½νΈ
- **evaluate_model.py**: μΆ…ν•© λ¨λΈ ν‰κ°€ μ¤ν¬λ¦½νΈ
- W&B ν†µν•©, μλ™ ν‰κ°€, λ°°μΉ μ²λ¦¬
- μ„λ² λ”©/μƒμ„±/κ²€μƒ‰/End-to-End ν‰κ°€

**μ‚¬μ©λ²•:**
```bash
# λ¨λΈ ν›λ ¨
python scripts/train_model.py --model-type generation --use-lora

# λ¨λΈ ν‰κ°€
python scripts/evaluate_model.py --model-type embedding --health-check
```

### 11. β… λ°°ν¬ μ‹μ¤ν… (Deployment System)
- **Docker** λ©€ν‹°μ¤ν…μ΄μ§€ λΉλ“
- **Docker Compose** μ „μ²΄ μ¤νƒ μ¤μΌ€μ¤νΈλ μ΄μ…
- **Nginx** λ¦¬λ²„μ¤ ν”„λ΅μ‹ λ° λ΅λ“λ°Έλ°μ‹±
- **λ°°ν¬ μ¤ν¬λ¦½νΈ** (deploy.sh) μλ™ν™”

**μΈν”„λΌ κµ¬μ„±:**
```yaml
services:
  - fragrance_ai (λ©”μΈ μ•±)
  - postgres (λ°μ΄ν„°λ² μ΄μ¤)
  - redis (μΊμ‹/μ„Έμ…)
  - chroma (λ²΅ν„° DB)
  - celery_worker (λΉ„λ™κΈ° μ‘μ—…)
  - prometheus (λ¨λ‹ν„°λ§)
  - grafana (μ‹κ°ν™”)
```

### 12. β… μ„¤μ • κ΄€λ¦¬ (Configuration Management)
- **ν™κ²½λ³„ μ„¤μ •**: development.json, production.json
- **ν™κ²½ λ³€μ κ΄€λ¦¬**: .env.example
- **λ³΄μ• μ„¤μ •**: JWT, Rate Limiting, HTTPS
- **λ¨λ‹ν„°λ§ μ„¤μ •**: Prometheus, Grafana, μ•λ¦Ό

**μ„¤μ • μμ‹:**
```json
{
  "models": {
    "embedding": {...},
    "generation": {...}
  },
  "api": {...},
  "security": {...}
}
```

## μ‹μ¤ν… μ•„ν‚¤ν…μ² μ™„μ„±λ„

### β… μ™„λ£λ λ μ΄μ–΄
1. **API λ μ΄μ–΄**: FastAPI, λΌμ°ν…, λ―Έλ“¤μ›¨μ–΄, μμ΅΄μ„± κ΄€λ¦¬
2. **μ„λΉ„μ¤ λ μ΄μ–΄**: λΉ„μ¦λ‹μ¤ λ΅μ§, μΊμ‹±, ν’μ§ κ΄€λ¦¬
3. **λ¨λΈ λ μ΄μ–΄**: μ„λ² λ”©, μƒμ„±, PEFT ν›λ ¨
4. **λ°μ΄ν„° λ μ΄μ–΄**: PostgreSQL, Redis, ChromaDB
5. **ν‰κ°€ λ μ΄μ–΄**: λ©”νΈλ¦­ κ³„μ‚°, ν’μ§ ν‰κ°€
6. **λ°°ν¬ λ μ΄μ–΄**: Docker, μ¤μΌ€μ¤νΈλ μ΄μ…, λ¨λ‹ν„°λ§

### π”„ μ‹¤μ  μ΄μμ„ μ„ν• μ¶”κ°€ κ³ λ ¤μ‚¬ν•­

1. **λ°μ΄ν„° νμ΄ν”„λΌμΈ κµ¬μ¶•**
   - Apache Airflow μ›ν¬ν”λ΅μ°
   - μ›Ή μ¤ν¬λν•‘ μλ™ν™”
   - λ°μ΄ν„° μ •μ /λ³€ν™
   - μ„λ² λ”© μ—…λ°μ΄νΈ μλ™ν™”

2. **κ³ κΈ‰ λ¨λΈ μµμ ν™”**
   - vLLMμ„ ν†µν• μ¶”λ΅  κ°€μ†ν™”
   - ONNX λ¨λΈ μµμ ν™”
   - λ¨λΈ μ–‘μν™” λ° ν”„λ£¨λ‹
   - ν•μ΄λΈλ¦¬λ“ μ¶”μ² μ‹μ¤ν…

3. **μ¤μΌ€μΌλ§ λ° μ„±λ¥**
   - Kubernetes μ¤μΌ€μ¤νΈλ μ΄μ…
   - μ¤ν† μ¤μΌ€μΌλ§ μ •μ±…
   - CDN ν†µν•©
   - λ°μ΄ν„°λ² μ΄μ¤ μƒ¤λ”©

4. **μ‚¬μ©μ μΈν„°νμ΄μ¤**
   - React/Vue.js ν”„λ΅ νΈμ—”λ“
   - κ΄€λ¦¬μ λ€μ‹λ³΄λ“
   - λ¨λ°”μΌ μ•±
   - API λ¬Έμ„ν™” (Swagger/OpenAPI)

## ν„μ¬ μ‹μ¤ν…μ μƒμ©ν™” μ¤€λΉ„λ„: 85%

### β… μ™„λ£λ ν•µμ‹¬ κΈ°λ¥
- AI λ¨λΈ (μ„λ² λ”©, μƒμ„±) β“
- μλ―Έ κ²€μƒ‰ μ‹μ¤ν… β“  
- API λ°±μ—”λ“ β“
- λ°μ΄ν„°λ² μ΄μ¤ μ¤ν‚¤λ§ β“
- λ°°ν¬ μΈν”„λΌ β“
- λ¨λ‹ν„°λ§ λ° λ΅κΉ… β“
- ν’μ§ ν‰κ°€ μ‹μ¤ν… β“

### π”„ μ¶”κ°€ ν•„μ” μ‚¬ν•­
- μ‹¤μ  ν–¥μ λ°μ΄ν„°μ…‹ κµ¬μ¶•
- μ‚¬μ©μ μΈν„°νμ΄μ¤ κ°λ°
- μƒμ© λΌμ΄μ„Όμ¤ κ²€ν† 
- λ³΄μ• κ°μ‚¬ λ° ν…μ¤νΈ
- μ„±λ¥ λ²¤μΉλ§ν‚Ή λ° μµμ ν™”

## κΈ°μ μ  μ°μμ„±

### π† νμ‹ μ  νΉμ§•
1. **ν•κµ­μ–΄ νΉν™” AI**: ν–¥μ μ „λ¬Έ μ©μ–΄ λ° ν•κµ­ μ‹μ¥ λ§μ¶¤ν™”
2. **ν•μ΄λΈλ¦¬λ“ κ²€μƒ‰**: λ²΅ν„° κ²€μƒ‰ + μ „ν†µμ  ν•„ν„°λ§
3. **PEFT ν›λ ¨**: ν¨μ¨μ  λ¨λΈ λ―Έμ„Έμ΅°μ • (LoRA/QLoRA)
4. **ν’μ§ λ³΄μ¦**: μλ™ ν’μ§ ν‰κ°€ λ° ν”Όλ“λ°±
5. **μƒμ©κΈ‰ μ•„ν‚¤ν…μ²**: ν™•μ¥ κ°€λ¥ν•κ³  μ•μ •μ μΈ μ„¤κ³„

### π― μ‹μ¥ μ°¨λ³„ν™” μ”μ†
- **AI κΈ°λ° μ°½μμ  λ μ‹ν”Ό μƒμ„±**
- **μλ―Έ κΈ°λ° ν–¥μ κ²€μƒ‰**
- **κ°μΈν™” μ¶”μ² (ν™•μ¥ κ°€λ¥)**
- **μ „λ¬Έκ°€ μμ¤€ ν’μ§ ν‰κ°€**
- **μ‹¤μ‹κ°„ νΈλ λ“ λ¶„μ„ (ν™•μ¥ κ°€λ¥)**